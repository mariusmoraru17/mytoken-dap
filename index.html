<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>MyToken Wallet</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 2rem;
        background-color: #f9f9f9;
      }

      h1 {
        color: #333;
      }

      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        margin: 10px;
      }

      input {
        padding: 10px;
        font-size: 16px;
        margin: 5px;
        width: 250px;
      }

      #balance {
        margin-top: 1rem;
        font-weight: bold;
      }

      .container {
        background: #fff;
        padding: 2rem;
        margin: auto;
        max-width: 600px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>MyToken Wallet</h1>
      <button onclick="connectWallet()">Connect MetaMask</button>
      <div id="wallet" style="margin: 1rem 0;"></div>
      <div id="balance"></div>

      <h3>Send Tokens</h3>
      <input type="text" id="recipient" placeholder="Recipient Address" />
      <input type="number" id="amount" placeholder="Amount" />
      <button onclick="sendTokens()">Send</button>
    </div>

    <script>
      const tokenAddress = "0x07d2920a5785298C22A6E462EE3Db457DF589D5E";
      const tokenABI = [
        "function name() public view returns (string)",
        "function symbol() public view returns (string)",
        "function decimals() public view returns (uint8)",
        "function totalSupply() public view returns (uint256)",
        "function balanceOf(address) public view returns (uint)",
        "function transfer(address to, uint amount) public returns (bool)"
      ];

      let provider, signer, token, userAddress;

      async function connectWallet() {
        try {
          if (!window.ethereum) throw new Error("MetaMask not detected");

          await ethereum.request({ method: "eth_requestAccounts" });

          provider = new ethers.providers.Web3Provider(window.ethereum);
          signer = provider.getSigner();
          userAddress = await signer.getAddress();

          document.getElementById("wallet").textContent = "Connected: " + userAddress;

          token = new ethers.Contract(tokenAddress, tokenABI, signer);

          const decimals = await token.decimals();
          const balance = await token.balanceOf(userAddress);
          const symbol = await token.symbol();

          document.getElementById("balance").textContent =
            "Balance: " + ethers.utils.formatUnits(balance, decimals) + " " + symbol;
        } catch (err) {
          alert("Failed to connect wallet: " + err.message);
        }
      }

      async function sendTokens() {
        try {
          const to = document.getElementById("recipient").value;
          const amount = document.getElementById("amount").value;
          const decimals = await token.decimals();
          const value = ethers.utils.parseUnits(amount, decimals);

          const tx = await token.transfer(to, value);
          await tx.wait();

          alert("Tokens sent successfully!");

          const newBalance = await token.balanceOf(userAddress);
          const symbol = await token.symbol();
          document.getElementById("balance").textContent =
            "Balance: " + ethers.utils.formatUnits(newBalance, decimals) + " " + symbol;
        } catch (err) {
          alert("Error sending tokens: " + err.message);
        }
      }
    </script>
  </body>
</html>
